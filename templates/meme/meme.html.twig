{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block body %}
    {% if id %}
        <div class="row">
            <div class="col-md-6" style="position: sticky; top: 0; height: 100vh; overflow-y: auto;">
                <h1>{{ selectedmeme['name'] }}</h1> 
                <img src="data:image;base64,{{selectedmeme['image']}}" style="max-width:80vw"/>
                <p>{{ selectedmeme['description'] }}</p>
            </div>
            <!-- Section Commentaire -->
            <div class="col-md-6">
                <h2>Comments</h2>
                {% if commentaires is not empty %}
                    <div class="comment-list">
                        {% for commentaire in commentaires %}
                            <div class="comment-box">
                            <style>
                            strong:hover {
                                color:#9A1A4A;
                            }
                            </style>
                                <strong onclick="window.location.href='profil?id={{commentaire.userId}}'">{{ commentaire.prenom }}</strong>:
                                <p>{{ commentaire.commentaire }}</p>
                                {% if session['userid'] == commentaire.userId %}
                                    <form method="post" action="/delete-comment/{{ commentaire.id }}" class="float-right">
                                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                    </form>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p>No comments yet.</p>
                {% endif %}
                {% if session['userid'] %}
                    <form method="post" action="/meme?id={{ id }}">
                        <div class="form-group">
                            <label for="comment">Add a comment:</label>
                            <textarea id="comment" name="comment" rows="4" class="form-control" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                {% else %}
                    <p>You have to be connected to post any comments.</p>
                {% endif %}
            </div>
        </div>
    {% else %}
        <h1>Les memes</h1>
        <a href="/meme/post" class="btn btn-primary mb-3" style="float: right;">Add Yours !</a>

        <div class="row">
            {% for meme in memes %}
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <img class="card-img-top" src="data:image;base64,{{ meme.image }}" alt="Meme image">
                        <div class="card-body">
                            <h5 class="card-title">{{ meme.name }}</h5>
                            <p class="card-text">{{ meme.description|slice(0, 100) }}</p>
                            <a href="/meme?id={{ meme.id }}" class="btn btn-primary">View this meme</a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}
